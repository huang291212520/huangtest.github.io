(function(e){function t(t){for(var o,s,i=t[0],c=t[1],l=t[2],u=0,f=[];u<i.length;u++)s=i[u],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&f.push(a[s][0]),a[s]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);d&&d(t);while(f.length)f.shift()();return n.push.apply(n,l||[]),r()}function r(){for(var e,t=0;t<n.length;t++){for(var r=n[t],o=!0,i=1;i<r.length;i++){var c=r[i];0!==a[c]&&(o=!1)}o&&(n.splice(t--,1),e=s(s.s=r[0]))}return e}var o={},a={index:0},n=[];function s(t){if(o[t])return o[t].exports;var r=o[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=o,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(r,o,function(t){return e[t]}.bind(null,o));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var i=this["webpackJsonp"]=this["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var d=c;n.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"56d7":function(e,t,r){"use strict";r.r(t);var o=r("2b0e"),a=(r("a573"),function(){var e=this,t=e._self._c,r=e._self._setupProxy;return t("div",[t("p",{on:{click:function(e){r.show=!r.show}}},[e._v("切换/隐藏 ("+e._s(r.show?"显示":"隐藏")+")")]),t("p",{on:{click:r.toBaidu}},[e._v("跳转其他站点")]),r.show?[t("p",[e._v(" Modern mobile phones often have a variety of different cameras installed (e.g. front, rear, wide-angle, infrared, desk-view). The one picked by default is sometimes not the best choice. For more fine-grained control, you can select a camera by device constraints or by the device ID: "),t("select",{directives:[{name:"model",rawName:"v-model",value:r.selectedConstraints,expression:"selectedConstraints"}],on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));r.selectedConstraints=e.target.multiple?t:t[0]}}},e._l(r.constraintOptions,(function(r){return t("option",{key:r.label,domProps:{value:r.constraints}},[e._v(" "+e._s(r.label)+" ")])})),0)]),t("p",{staticClass:"error"},[e._v(e._s(r.error))]),t("p",{staticClass:"decode-result"},[e._v(" Last result: "),t("b",[e._v(e._s(r.result))])]),t("div",[t(r.QrcodeStream,{attrs:{constraints:r.selectedConstraints},on:{error:r.onError,detect:r.onDetect,"camera-on":r.onCameraReady}})],1)]:e._e()],2)}),n=[],s=(r("0643"),r("2382"),function(){var e=this,t=e._self._c,r=e._self._setupProxy;return t("div",{style:r.wrapperStyle},[t("video",{ref:"videoRef",style:r.videoElStyle,attrs:{autoplay:"",muted:"",playsinline:""},domProps:{muted:!0}}),t("canvas",{directives:[{name:"show",rawName:"v-show",value:!r.shouldScan,expression:"!shouldScan"}],ref:"pauseFrameRef",style:r.cameraStyle,attrs:{id:"qrcode-stream-pause-frame"}}),t("canvas",{ref:"trackingLayerRef",style:r.overlayStyle,attrs:{id:"qrcode-stream-tracking-layer"}}),t("div",{style:r.overlayStyle},[e._t("default")],2)])}),i=[],c=(r("9a9a"),r("7a23"));const l=(e,t,r="error")=>{let o,a;const n=new Promise((n,s)=>{o=n,a=s,e.addEventListener(t,o),e.addEventListener(r,a)});return n.finally(()=>{e.removeEventListener(t,o),e.removeEventListener(r,a)}),n},d=e=>new Promise(t=>setTimeout(t,e));r("d9e2");class u extends Error{constructor(){super("can't process cross-origin image"),this.name="DropImageFetchError"}}class f extends Error{constructor(){super("this browser has no Stream API support"),this.name="StreamApiNotSupportedError"}}class p extends Error{constructor(){super("camera access is only permitted in secure context. Use HTTPS or localhost rather than HTTP."),this.name="InsecureContextError"}}class v extends Error{constructor(){super("Loading camera stream timed out after 6 seconds. If you are on iOS in PWA mode, this is a known issue (see https://github.com/gruhn/vue-qrcode-reader/issues/298)"),this.name="StreamLoadTimeoutError"}}let m;async function h(e){if(void 0===window.BarcodeDetector)return console.debug("[vue-qrcode-reader] Native BarcodeDetector not supported. Will use polyfill."),new c["a"]({formats:e});const t=await window.BarcodeDetector.getSupportedFormats(),r=e.filter(e=>!t.includes(e));return r.length>0?(console.debug(`[vue-qrcode-reader] Native BarcodeDetector does not support formats ${JSON.stringify(r)}. Will use polyfill.`),new c["a"]({formats:e})):(console.debug("[vue-qrcode-reader] Will use native BarcodeDetector."),new window.BarcodeDetector({formats:e}))}async function w(e){m=await h(e)}const y=async(e,{detectHandler:t,locateHandler:r,minDelay:o,formats:a})=>{console.debug("[vue-qrcode-reader] start scanning"),await w(a);const n=a=>async s=>{if(0===e.readyState)console.debug("[vue-qrcode-reader] stop scanning: video element readyState is 0");else{const{lastScanned:i,contentBefore:c,lastScanHadContent:l}=a;if(s-i<o)window.requestAnimationFrame(n(a));else{const o=await m.detect(e),a=o.some(e=>!c.includes(e.rawValue));a&&t(o);const i=o.length>0;i&&r(o),!i&&l&&r(o);const d={lastScanned:s,lastScanHadContent:i,contentBefore:a?o.map(e=>e.rawValue):c};window.requestAnimationFrame(n(d))}}};n({lastScanned:performance.now(),contentBefore:[],lastScanHadContent:!1})(performance.now())},g=async e=>{if(e.startsWith("http")&&!1===e.includes(location.host))throw new u;const t=document.createElement("img");return t.src=e,await l(t,"load"),t},b=async(e,t=["qr_code"])=>{const r=new c["a"]({formats:t});return await r.detect(e)},O=async(e,t=["qr_code"])=>{const r=new c["a"]({formats:t}),o=await g(e);return await r.detect(o)};r("88a7"),r("271a"),r("5494");var S=r("1c48"),_=r("5fe3"),j=r("dbe1"),x=r("f953");const E=e=>{let t=!1,r=void 0;return(...o)=>(t||(r=e(o),t=!0),r)};function k(e,t){if(!1===e)throw new Error(null!==t&&void 0!==t?t:"assertion failure")}function P(e){throw new Error("this code should be unreachable")}var T=E(()=>{const e=Object(x["detectBrowser"])(window);switch(e.browser){case"chrome":Object(S["shimGetUserMedia"])(window,e);break;case"firefox":Object(_["shimGetUserMedia"])(window,e);break;case"safari":Object(j["shimGetUserMedia"])(window,e);break;default:throw new f}});let D=Promise.resolve({type:"stop",data:{}});async function C(e,t,r){var o,a,n;if(console.debug("[vue-qrcode-reader] starting camera with constraints: ",JSON.stringify(t)),!0!==window.isSecureContext)throw new p;if(void 0===(null===(o=navigator)||void 0===o||null===(o=o.mediaDevices)||void 0===o?void 0:o.getUserMedia))throw new f;T(),console.debug("[vue-qrcode-reader] calling getUserMedia");const s=await navigator.mediaDevices.getUserMedia({audio:!1,video:t});void 0!==e.srcObject?e.srcObject=s:void 0!==e.mozSrcObject?e.mozSrcObject=s:window.URL.createObjectURL?e.src=window.URL.createObjectURL(s):window.webkitURL?e.src=window.webkitURL.createObjectURL(s):e.src=s.id,e.play(),console.debug("[vue-qrcode-reader] waiting for video element to load"),await Promise.race([l(e,"loadeddata"),d(6).then(()=>{throw new v})]),console.debug("[vue-qrcode-reader] video element loaded"),await d(500);const[i]=s.getVideoTracks(),c=null!==(a=null===i||void 0===i||null===(n=i.getCapabilities)||void 0===n?void 0:n.call(i))&&void 0!==a?a:{};let u=!1;return r&&c.torch&&(await i.applyConstraints({advanced:[{torch:!0}]}),u=!0),console.debug("[vue-qrcode-reader] camera ready"),{type:"start",data:{videoEl:e,stream:s,capabilities:c,constraints:t,isTorchOn:u}}}async function q(e,{constraints:t,torch:r,restart:o=!1}){D=D.then(a=>{if("start"===a.type){const{data:{videoEl:n,stream:s,constraints:i,isTorchOn:c}}=a;return o||e!==n||t!==i||r!==c?M(n,s,c).then(()=>C(e,t,r)):a}if("stop"===a.type||"failed"===a.type)return C(e,t,r);P(a)}).catch(e=>(console.debug(`[vue-qrcode-reader] starting camera failed with "${e}"`),{type:"failed",error:e}));const a=await D;if("stop"===a.type)throw new Error("Something went wrong with the camera task queue (start task).");if("failed"===a.type)throw a.error;if("start"===a.type)return a.data.capabilities;P(a)}async function M(e,t,r){console.debug("[vue-qrcode-reader] stopping camera"),e.src="",e.srcObject=null,e.load(),await l(e,"error");for(const o of t.getTracks())null!==r&&void 0!==r||await o.applyConstraints({advanced:[{torch:!1}]}),t.removeTrack(o),o.stop();return{type:"stop",data:{}}}async function L(){D=D.then(e=>{if("stop"===e.type||"failed"===e.type)return e;const{data:{videoEl:t,stream:r,isTorchOn:o}}=e;return M(t,r,o)});const e=await D;if("start"===e.type)throw new Error("Something went wrong with the camera task queue (stop task).")}var R=Object(o["c"])({__name:"QrcodeStream",props:{constraints:{type:Object,default(){return{facingMode:"environment"}}},formats:{type:Array,default:()=>["qr_code"]},paused:{type:Boolean,default:!1},torch:{type:Boolean,default:!1},track:{type:Function}},emits:["detect","camera-on","camera-off","error"],setup(e,{emit:t}){const r=e,a=Object(o["f"])(r.constraints),n=Object(o["f"])(r.formats);Object(o["g"])(()=>r.constraints,(e,t)=>{JSON.stringify(e)!==JSON.stringify(t)&&(a.value=e)},{deep:!0}),Object(o["g"])(()=>r.formats,(e,t)=>{JSON.stringify(e)!==JSON.stringify(t)&&(n.value=e)},{deep:!0});const s=Object(o["f"])(),i=Object(o["f"])(),c=Object(o["f"])(),l=Object(o["f"])(!1),d=Object(o["f"])(!1);Object(o["d"])(()=>{d.value=!0}),Object(o["e"])(()=>{L()});const u=Object(o["a"])(()=>({torch:r.torch,constraints:a.value,shouldStream:d.value&&!r.paused}));Object(o["g"])(u,async e=>{const r=c.value;k(void 0!==r,"cameraSettings watcher should never be triggered when component is not mounted. Thus video element should always be defined.");const o=s.value;k(void 0!==o,"cameraSettings watcher should never be triggered when component is not mounted. Thus canvas should always be defined.");const a=o.getContext("2d");if(k(null!==a,"if cavnas is defined, canvas 2d context should also be non-null"),e.shouldStream){L(),l.value=!1;try{const o=await q(r,e);d.value?(l.value=!0,t("camera-on",o)):await L()}catch(n){t("error",n)}}else o.width=r.videoWidth,o.height=r.videoHeight,a.drawImage(r,0,0,r.videoWidth,r.videoHeight),L(),l.value=!1,t("camera-off")},{deep:!0}),Object(o["g"])(n,async e=>{d.value&&await w(e)});const f=Object(o["a"])(()=>u.value.shouldStream&&l.value);Object(o["g"])(f,e=>{if(e){k(void 0!==s.value,"shouldScan watcher should only be triggered when component is mounted. Thus pause frame canvas is defined"),p(s.value),k(void 0!==i.value,"shouldScan watcher should only be triggered when component is mounted. Thus tracking canvas is defined"),p(i.value);const e=()=>void 0===r.track?500:40;k(void 0!==c.value,"shouldScan watcher should only be triggered when component is mounted. Thus video element is defined"),y(c.value,{detectHandler:e=>t("detect",e),formats:n.value,locateHandler:v,minDelay:e()})}});const p=e=>{const t=e.getContext("2d");k(null!==t,"canvas 2d context should always be non-null"),t.clearRect(0,0,e.width,e.height)},v=e=>{const t=i.value;k(void 0!==t,"onLocate handler should only be called when component is mounted. Thus tracking canvas is always defined.");const o=c.value;if(k(void 0!==o,"onLocate handler should only be called when component is mounted. Thus video element is always defined."),0===e.length||void 0===r.track)p(t);else{const a=o.offsetWidth,n=o.offsetHeight,s=o.videoWidth,i=o.videoHeight,c=Math.max(a/s,n/i),l=s*c,d=i*c,u=l/s,f=d/i,p=(a-l)/2,v=(n-d)/2,m=({x:e,y:t})=>({x:Math.floor(e*u),y:Math.floor(t*f)}),h=({x:e,y:t})=>({x:Math.floor(e+p),y:Math.floor(t+v)}),w=e.map(e=>{const{boundingBox:t,cornerPoints:r}=e,{x:o,y:a}=h(m({x:t.x,y:t.y})),{x:n,y:s}=m({x:t.width,y:t.height});return{...e,cornerPoints:r.map(e=>h(m(e))),boundingBox:DOMRectReadOnly.fromRect({x:o,y:a,width:n,height:s})}});t.width=o.offsetWidth,t.height=o.offsetHeight;const y=t.getContext("2d");r.track(w,y)}},m={width:"100%",height:"100%",position:"relative","z-index":"0"},h={width:"100%",height:"100%",position:"absolute",top:"0",left:"0"},g={width:"100%",height:"100%","object-fit":"cover"},b=Object(o["a"])(()=>f.value?g:{...g,visibility:"hidden",position:"absolute"});return{__sfc:!0,props:r,emit:t,constraintsCached:a,formatsCached:n,pauseFrameRef:s,trackingLayerRef:i,videoRef:c,cameraActive:l,isMounted:d,cameraSettings:u,shouldScan:f,clearCanvas:p,onLocate:v,wrapperStyle:m,overlayStyle:h,cameraStyle:g,videoElStyle:b}}}),H=R,N=r("2877"),A=Object(N["a"])(H,s,i,!1,null,null,null),B=A.exports,U=function(){var e=this,t=e._self._c,r=e._self._setupProxy;return t("input",{attrs:{type:"file",name:"image",accept:"image/*",capture:"environment",multiple:""},on:{change:r.onChangeInput}})},I=[],W=Object(o["c"])({__name:"QrcodeCapture",props:{formats:{type:Array,default:()=>["qr_code"]}},emits:["detect"],setup(e,{emit:t}){const r=e,o=e=>{if(e.target instanceof HTMLInputElement&&e.target.files)for(const o of Array.from(e.target.files))b(o,r.formats).then(e=>{t("detect",e)})};return{__sfc:!0,props:r,emit:t,onChangeInput:o}}}),F=W,J=Object(N["a"])(F,U,I,!1,null,null,null),$=(J.exports,function(){var e=this,t=e._self._c,r=e._self._setupProxy;return t("div",{on:{drop:function(e){return e.preventDefault(),e.stopPropagation(),r.onDrop.apply(null,arguments)},dragenter:function(e){return e.preventDefault(),e.stopPropagation(),r.onDragOver(!0)},dragleave:function(e){return e.preventDefault(),e.stopPropagation(),r.onDragOver(!1)},dragover:function(e){e.preventDefault(),e.stopPropagation()}}},[e._t("default")],2)}),Q=[],V=(r("4e3e"),Object(o["c"])({__name:"QrcodeDropZone",props:{formats:{type:Array,default:()=>["qr_code"]}},emits:["detect","dragover","error"],setup(e,{emit:t}){const r=e,o=async e=>{try{const r=await e;t("detect",r)}catch(r){t("error",r)}},a=e=>{t("dragover",e)},n=({dataTransfer:e})=>{if(!e)return;a(!1);const t=[...Array.from(e.files)],n=e.getData("text/uri-list");t.forEach(e=>{o(b(e,r.formats))}),""!==n&&o(O(n,r.formats))};return{__sfc:!0,props:r,emit:t,onDetect:o,onDragOver:a,onDrop:n}}})),z=V,G=Object(N["a"])(z,$,Q,!1,null,null,null);G.exports;var Z=Object(o["c"])({__name:"App",setup(e){const t=Object(o["f"])(!1),r=()=>{window.location.href="https://www.baidu.com"},a=Object(o["f"])("");function n(e){console.log(e),a.value=JSON.stringify(e.map(e=>e.rawValue))}const s=Object(o["f"])({facingMode:"environment"}),i=[{label:"rear camera",constraints:{facingMode:"environment"}},{label:"front camera",constraints:{facingMode:"user"}}],c=Object(o["f"])(i);async function l(){const e=await navigator.mediaDevices.enumerateDevices(),t=e.filter(({kind:e})=>"videoinput"===e);c.value=[...i,...t.map(({deviceId:e,label:t})=>({label:`${t} (ID: ${e})`,constraints:{deviceId:e}}))],d.value=""}const d=Object(o["f"])("");function u(e){d.value=`[${e.name}]: `,"NotAllowedError"===e.name?d.value+="you need to grant camera access permission":"NotFoundError"===e.name?d.value+="no camera on this device":"NotSupportedError"===e.name?d.value+="secure context required (HTTPS, localhost)":"NotReadableError"===e.name?d.value+="is the camera already in use?":"OverconstrainedError"===e.name?d.value+="installed cameras are not suitable":"StreamApiNotSupportedError"===e.name?d.value+="Stream API is not supported in this browser":"InsecureContextError"===e.name?d.value+="Camera access is only permitted in secure context. Use HTTPS or localhost rather than HTTP.":d.value+=e.message}return{__sfc:!0,show:t,toBaidu:r,result:a,onDetect:n,selectedConstraints:s,defaultConstraintOptions:i,constraintOptions:c,onCameraReady:l,error:d,onError:u,QrcodeStream:B}}}),K=Z,X=Object(N["a"])(K,a,n,!1,null,"92fbab26",null),Y=X.exports;o["b"].config.productionTip=!1,new o["b"]({render:e=>e(Y)}).$mount("#app")}});